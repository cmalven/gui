!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Gui=t()}(this,(function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=function(e){return e&&e.Math==Math&&e},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")(),o=function(e){try{return!!e()}catch(e){return!0}},i=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),a={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,l={f:s&&!a.call({1:2},1)?function(e){var t=s(this,e);return!!t&&t.enumerable}:a},u=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},c={}.toString,d=function(e){return c.call(e).slice(8,-1)},f="".split,h=o((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==d(e)?f.call(e,""):Object(e)}:Object,p=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},_=function(e){return h(p(e))},m=function(e){return"object"==typeof e?null!==e:"function"==typeof e},g=function(e,t){if(!m(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!m(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},b={}.hasOwnProperty,v=function(e,t){return b.call(e,t)},y=r.document,E=m(y)&&m(y.createElement),S=function(e){return E?y.createElement(e):{}},w=!i&&!o((function(){return 7!=Object.defineProperty(S("div"),"a",{get:function(){return 7}}).a})),x=Object.getOwnPropertyDescriptor,A={f:i?x:function(e,t){if(e=_(e),t=g(t,!0),w)try{return x(e,t)}catch(e){}if(v(e,t))return u(!l.f.call(e,t),e[t])}},C=function(e){if(!m(e))throw TypeError(String(e)+" is not an object");return e},I=Object.defineProperty,M={f:i?I:function(e,t,n){if(C(e),t=g(t,!0),C(n),w)try{return I(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},T=i?function(e,t,n){return M.f(e,t,u(1,n))}:function(e,t,n){return e[t]=n,e},N=function(e,t){try{T(r,e,t)}catch(n){r[e]=t}return t},k=r["__core-js_shared__"]||N("__core-js_shared__",{}),O=Function.toString;"function"!=typeof k.inspectSource&&(k.inspectSource=function(e){return O.call(e)});var R,D,P,L=k.inspectSource,H=r.WeakMap,G="function"==typeof H&&/native code/.test(L(H)),B=t((function(e){(e.exports=function(e,t){return k[e]||(k[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),j=0,F=Math.random(),V=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++j+F).toString(36)},z=B("keys"),U=function(e){return z[e]||(z[e]=V(e))},Y={},K=r.WeakMap;if(G){var W=new K,X=W.get,q=W.has,J=W.set;R=function(e,t){return J.call(W,e,t),t},D=function(e){return X.call(W,e)||{}},P=function(e){return q.call(W,e)}}else{var $=U("state");Y[$]=!0,R=function(e,t){return T(e,$,t),t},D=function(e){return v(e,$)?e[$]:{}},P=function(e){return v(e,$)}}var Q,Z,ee={set:R,get:D,has:P,enforce:function(e){return P(e)?D(e):R(e,{})},getterFor:function(e){return function(t){var n;if(!m(t)||(n=D(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},te=t((function(e){var t=ee.get,n=ee.enforce,o=String(String).split("String");(e.exports=function(e,t,i,a){var s=!!a&&!!a.unsafe,l=!!a&&!!a.enumerable,u=!!a&&!!a.noTargetGet;"function"==typeof i&&("string"!=typeof t||v(i,"name")||T(i,"name",t),n(i).source=o.join("string"==typeof t?t:"")),e!==r?(s?!u&&e[t]&&(l=!0):delete e[t],l?e[t]=i:T(e,t,i)):l?e[t]=i:N(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||L(this)}))})),ne=r,re=function(e){return"function"==typeof e?e:void 0},oe=function(e,t){return arguments.length<2?re(ne[e])||re(r[e]):ne[e]&&ne[e][t]||r[e]&&r[e][t]},ie=Math.ceil,ae=Math.floor,se=function(e){return isNaN(e=+e)?0:(e>0?ae:ie)(e)},le=Math.min,ue=function(e){return e>0?le(se(e),9007199254740991):0},ce=Math.max,de=Math.min,fe=function(e,t){var n=se(e);return n<0?ce(n+t,0):de(n,t)},he=function(e){return function(t,n,r){var o,i=_(t),a=ue(i.length),s=fe(r,a);if(e&&n!=n){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},pe={includes:he(!0),indexOf:he(!1)},_e=pe.indexOf,me=function(e,t){var n,r=_(e),o=0,i=[];for(n in r)!v(Y,n)&&v(r,n)&&i.push(n);for(;t.length>o;)v(r,n=t[o++])&&(~_e(i,n)||i.push(n));return i},ge=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],be=ge.concat("length","prototype"),ve={f:Object.getOwnPropertyNames||function(e){return me(e,be)}},ye={f:Object.getOwnPropertySymbols},Ee=oe("Reflect","ownKeys")||function(e){var t=ve.f(C(e)),n=ye.f;return n?t.concat(n(e)):t},Se=function(e,t){for(var n=Ee(t),r=M.f,o=A.f,i=0;i<n.length;i++){var a=n[i];v(e,a)||r(e,a,o(t,a))}},we=/#|\.prototype\./,xe=function(e,t){var n=Ce[Ae(e)];return n==Me||n!=Ie&&("function"==typeof t?o(t):!!t)},Ae=xe.normalize=function(e){return String(e).replace(we,".").toLowerCase()},Ce=xe.data={},Ie=xe.NATIVE="N",Me=xe.POLYFILL="P",Te=xe,Ne=A.f,ke=function(e,t){var n,o,i,a,s,l=e.target,u=e.global,c=e.stat;if(n=u?r:c?r[l]||N(l,{}):(r[l]||{}).prototype)for(o in t){if(a=t[o],i=e.noTargetGet?(s=Ne(n,o))&&s.value:n[o],!Te(u?o:l+(c?".":"#")+o,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;Se(a,i)}(e.sham||i&&i.sham)&&T(a,"sham",!0),te(n,o,a,e)}},Oe=Array.isArray||function(e){return"Array"==d(e)},Re=function(e){return Object(p(e))},De=function(e,t,n){var r=g(t);r in e?M.f(e,r,u(0,n)):e[r]=n},Pe=!!Object.getOwnPropertySymbols&&!o((function(){return!String(Symbol())})),Le=Pe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,He=B("wks"),Ge=r.Symbol,Be=Le?Ge:Ge&&Ge.withoutSetter||V,je=function(e){return v(He,e)||(Pe&&v(Ge,e)?He[e]=Ge[e]:He[e]=Be("Symbol."+e)),He[e]},Fe=je("species"),Ve=function(e,t){var n;return Oe(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!Oe(n.prototype)?m(n)&&null===(n=n[Fe])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},ze=oe("navigator","userAgent")||"",Ue=r.process,Ye=Ue&&Ue.versions,Ke=Ye&&Ye.v8;Ke?Z=(Q=Ke.split("."))[0]+Q[1]:ze&&(!(Q=ze.match(/Edge\/(\d+)/))||Q[1]>=74)&&(Q=ze.match(/Chrome\/(\d+)/))&&(Z=Q[1]);var We=Z&&+Z,Xe=je("species"),qe=function(e){return We>=51||!o((function(){var t=[];return(t.constructor={})[Xe]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Je=je("isConcatSpreadable"),$e=We>=51||!o((function(){var e=[];return e[Je]=!1,e.concat()[0]!==e})),Qe=qe("concat"),Ze=function(e){if(!m(e))return!1;var t=e[Je];return void 0!==t?!!t:Oe(e)};ke({target:"Array",proto:!0,forced:!$e||!Qe},{concat:function(e){var t,n,r,o,i,a=Re(this),s=Ve(a,0),l=0;for(t=-1,r=arguments.length;t<r;t++)if(i=-1===t?a:arguments[t],Ze(i)){if(l+(o=ue(i.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<o;n++,l++)n in i&&De(s,l,i[n])}else{if(l>=9007199254740991)throw TypeError("Maximum allowed index exceeded");De(s,l++,i)}return s.length=l,s}});var et=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},tt=[].push,nt=function(e){var t=1==e,n=2==e,r=3==e,o=4==e,i=6==e,a=5==e||i;return function(s,l,u,c){for(var d,f,p=Re(s),_=h(p),m=function(e,t,n){if(et(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}(l,u,3),g=ue(_.length),b=0,v=c||Ve,y=t?v(s,g):n?v(s,0):void 0;g>b;b++)if((a||b in _)&&(f=m(d=_[b],b,p),e))if(t)y[b]=f;else if(f)switch(e){case 3:return!0;case 5:return d;case 6:return b;case 2:tt.call(y,d)}else if(o)return!1;return i?-1:r||o?o:y}},rt={forEach:nt(0),map:nt(1),filter:nt(2),some:nt(3),every:nt(4),find:nt(5),findIndex:nt(6)},ot=Object.defineProperty,it={},at=function(e){throw e},st=function(e,t){if(v(it,e))return it[e];t||(t={});var n=[][e],r=!!v(t,"ACCESSORS")&&t.ACCESSORS,a=v(t,0)?t[0]:at,s=v(t,1)?t[1]:void 0;return it[e]=!!n&&!o((function(){if(r&&!i)return!0;var e={length:-1};r?ot(e,1,{enumerable:!0,get:at}):e[1]=1,n.call(e,a,s)}))},lt=rt.filter,ut=qe("filter"),ct=st("filter");ke({target:"Array",proto:!0,forced:!ut||!ct},{filter:function(e){return lt(this,e,arguments.length>1?arguments[1]:void 0)}});var dt,ft=Object.keys||function(e){return me(e,ge)},ht=i?Object.defineProperties:function(e,t){C(e);for(var n,r=ft(t),o=r.length,i=0;o>i;)M.f(e,n=r[i++],t[n]);return e},pt=oe("document","documentElement"),_t=U("IE_PROTO"),mt=function(){},gt=function(e){return"<script>"+e+"<\/script>"},bt=function(){try{dt=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;bt=dt?function(e){e.write(gt("")),e.close();var t=e.parentWindow.Object;return e=null,t}(dt):((t=S("iframe")).style.display="none",pt.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(gt("document.F=Object")),e.close(),e.F);for(var n=ge.length;n--;)delete bt.prototype[ge[n]];return bt()};Y[_t]=!0;var vt=Object.create||function(e,t){var n;return null!==e?(mt.prototype=C(e),n=new mt,mt.prototype=null,n[_t]=e):n=bt(),void 0===t?n:ht(n,t)},yt=je("unscopables"),Et=Array.prototype;null==Et[yt]&&M.f(Et,yt,{configurable:!0,value:vt(null)});var St,wt=rt.findIndex,xt=!0,At=st("findIndex");"findIndex"in[]&&Array(1).findIndex((function(){xt=!1})),ke({target:"Array",proto:!0,forced:xt||!At},{findIndex:function(e){return wt(this,e,arguments.length>1?arguments[1]:void 0)}}),St="findIndex",Et[yt][St]=!0;var Ct=function(e,t){var n=[][e];return!!n&&o((function(){n.call(null,t||function(){throw 1},1)}))},It=rt.forEach,Mt=Ct("forEach"),Tt=st("forEach"),Nt=Mt&&Tt?[].forEach:function(e){return It(this,e,arguments.length>1?arguments[1]:void 0)};ke({target:"Array",proto:!0,forced:[].forEach!=Nt},{forEach:Nt});var kt=pe.indexOf,Ot=[].indexOf,Rt=!!Ot&&1/[1].indexOf(1,-0)<0,Dt=Ct("indexOf"),Pt=st("indexOf",{ACCESSORS:!0,1:0});ke({target:"Array",proto:!0,forced:Rt||!Dt||!Pt},{indexOf:function(e){return Rt?Ot.apply(this,arguments)||0:kt(this,e,arguments.length>1?arguments[1]:void 0)}});var Lt=function(e){return function(t,n,r,o){et(n);var i=Re(t),a=h(i),s=ue(i.length),l=e?s-1:0,u=e?-1:1;if(r<2)for(;;){if(l in a){o=a[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw TypeError("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in a&&(o=n(o,a[l],l,i));return o}},Ht={left:Lt(!1),right:Lt(!0)}.left,Gt=Ct("reduce"),Bt=st("reduce",{1:0});ke({target:"Array",proto:!0,forced:!Gt||!Bt},{reduce:function(e){return Ht(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var jt=qe("splice"),Ft=st("splice",{ACCESSORS:!0,0:0,1:2}),Vt=Math.max,zt=Math.min;ke({target:"Array",proto:!0,forced:!jt||!Ft},{splice:function(e,t){var n,r,o,i,a,s,l=Re(this),u=ue(l.length),c=fe(e,u),d=arguments.length;if(0===d?n=r=0:1===d?(n=0,r=u-c):(n=d-2,r=zt(Vt(se(t),0),u-c)),u+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(o=Ve(l,r),i=0;i<r;i++)(a=c+i)in l&&De(o,i,l[a]);if(o.length=r,n<r){for(i=c;i<u-r;i++)s=i+n,(a=i+r)in l?l[s]=l[a]:delete l[s];for(i=u;i>u-r+n;i--)delete l[i-1]}else if(n>r)for(i=u-r;i>c;i--)s=i+n-1,(a=i+r-1)in l?l[s]=l[a]:delete l[s];for(i=0;i<n;i++)l[i+c]=arguments[i+2];return l.length=u-r+n,o}});var Ut=M.f,Yt=Function.prototype,Kt=Yt.toString,Wt=/^\s*function ([^ (]*)/;i&&!("name"in Yt)&&Ut(Yt,"name",{configurable:!0,get:function(){try{return Kt.call(this).match(Wt)[1]}catch(e){return""}}});var Xt="".repeat||function(e){var t=String(p(this)),n="",r=se(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n},qt=1..toFixed,Jt=Math.floor,$t=function(e,t,n){return 0===t?n:t%2==1?$t(e,t-1,n*e):$t(e*e,t/2,n)};ke({target:"Number",proto:!0,forced:qt&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){qt.call({})}))},{toFixed:function(e){var t,n,r,o,i=function(e){if("number"!=typeof e&&"Number"!=d(e))throw TypeError("Incorrect invocation");return+e}(this),a=se(e),s=[0,0,0,0,0,0],l="",u="0",c=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*s[n],s[n]=r%1e7,r=Jt(r/1e7)},f=function(e){for(var t=6,n=0;--t>=0;)n+=s[t],s[t]=Jt(n/e),n=n%e*1e7},h=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==s[e]){var n=String(s[e]);t=""===t?n:t+Xt.call("0",7-n.length)+n}return t};if(a<0||a>20)throw RangeError("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return String(i);if(i<0&&(l="-",i=-i),i>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(i*$t(2,69,1))-69)<0?i*$t(2,-t,1):i/$t(2,t,1),n*=4503599627370496,(t=52-t)>0){for(c(0,n),r=a;r>=7;)c(1e7,0),r-=7;for(c($t(10,r,1),0),r=t-1;r>=23;)f(1<<23),r-=23;f(1<<r),c(1,1),f(2),u=h()}else c(0,n),c(1<<-t,0),u=h()+Xt.call("0",a);return u=a>0?l+((o=u.length)<=a?"0."+Xt.call("0",a-o)+u:u.slice(0,o-a)+"."+u.slice(o-a)):l+u}});var Qt=Object.assign,Zt=Object.defineProperty,en=!Qt||o((function(){if(i&&1!==Qt({b:1},Qt(Zt({},"a",{enumerable:!0,get:function(){Zt(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=Qt({},e)[n]||"abcdefghijklmnopqrst"!=ft(Qt({},t)).join("")}))?function(e,t){for(var n=Re(e),r=arguments.length,o=1,a=ye.f,s=l.f;r>o;)for(var u,c=h(arguments[o++]),d=a?ft(c).concat(a(c)):ft(c),f=d.length,p=0;f>p;)u=d[p++],i&&!s.call(c,u)||(n[u]=c[u]);return n}:Qt;ke({target:"Object",stat:!0,forced:Object.assign!==en},{assign:en});var tn=function(){var e=C(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function nn(e,t){return RegExp(e,t)}var rn,on,an={UNSUPPORTED_Y:o((function(){var e=nn("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),BROKEN_CARET:o((function(){var e=nn("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},sn=RegExp.prototype.exec,ln=String.prototype.replace,un=sn,cn=(rn=/a/,on=/b*/g,sn.call(rn,"a"),sn.call(on,"a"),0!==rn.lastIndex||0!==on.lastIndex),dn=an.UNSUPPORTED_Y||an.BROKEN_CARET,fn=void 0!==/()??/.exec("")[1];(cn||fn||dn)&&(un=function(e){var t,n,r,o,i=this,a=dn&&i.sticky,s=tn.call(i),l=i.source,u=0,c=e;return a&&(-1===(s=s.replace("y","")).indexOf("g")&&(s+="g"),c=String(e).slice(i.lastIndex),i.lastIndex>0&&(!i.multiline||i.multiline&&"\n"!==e[i.lastIndex-1])&&(l="(?: "+l+")",c=" "+c,u++),n=new RegExp("^(?:"+l+")",s)),fn&&(n=new RegExp("^"+l+"$(?!\\s)",s)),cn&&(t=i.lastIndex),r=sn.call(a?n:i,c),a?r?(r.input=r.input.slice(u),r[0]=r[0].slice(u),r.index=i.lastIndex,i.lastIndex+=r[0].length):i.lastIndex=0:cn&&r&&(i.lastIndex=i.global?r.index+r[0].length:t),fn&&r&&r.length>1&&ln.call(r[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)})),r});var hn=un;ke({target:"RegExp",proto:!0,forced:/./.exec!==hn},{exec:hn});var pn=je("species"),_n=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),mn="$0"==="a".replace(/./,"$0"),gn=je("replace"),bn=!!/./[gn]&&""===/./[gn]("a","$0"),vn=!o((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),yn=function(e){return function(t,n){var r,o,i=String(p(t)),a=se(n),s=i.length;return a<0||a>=s?e?"":void 0:(r=i.charCodeAt(a))<55296||r>56319||a+1===s||(o=i.charCodeAt(a+1))<56320||o>57343?e?i.charAt(a):r:e?i.slice(a,a+2):o-56320+(r-55296<<10)+65536}},En={codeAt:yn(!1),charAt:yn(!0)}.charAt,Sn=function(e,t,n){return t+(n?En(e,t).length:1)},wn=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==d(e))throw TypeError("RegExp#exec called on incompatible receiver");return hn.call(e,t)},xn=Math.max,An=Math.min,Cn=Math.floor,In=/\$([$&'`]|\d\d?|<[^>]*>)/g,Mn=/\$([$&'`]|\d\d?)/g;!function(e,t,n,r){var i=je(e),a=!o((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),s=a&&!o((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[pn]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t}));if(!a||!s||"replace"===e&&(!_n||!mn||bn)||"split"===e&&!vn){var l=/./[i],u=n(i,""[e],(function(e,t,n,r,o){return t.exec===hn?a&&!o?{done:!0,value:l.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:mn,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:bn}),c=u[0],d=u[1];te(String.prototype,e,c),te(RegExp.prototype,i,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)})}r&&T(RegExp.prototype[i],"sham",!0)}("replace",2,(function(e,t,n,r){var o=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,i=r.REPLACE_KEEPS_$0,a=o?"$":"$0";return[function(n,r){var o=p(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,o,r):t.call(String(o),n,r)},function(e,r){if(!o&&i||"string"==typeof r&&-1===r.indexOf(a)){var l=n(t,e,this,r);if(l.done)return l.value}var u=C(e),c=String(this),d="function"==typeof r;d||(r=String(r));var f=u.global;if(f){var h=u.unicode;u.lastIndex=0}for(var p=[];;){var _=wn(u,c);if(null===_)break;if(p.push(_),!f)break;""===String(_[0])&&(u.lastIndex=Sn(c,ue(u.lastIndex),h))}for(var m,g="",b=0,v=0;v<p.length;v++){_=p[v];for(var y=String(_[0]),E=xn(An(se(_.index),c.length),0),S=[],w=1;w<_.length;w++)S.push(void 0===(m=_[w])?m:String(m));var x=_.groups;if(d){var A=[y].concat(S,E,c);void 0!==x&&A.push(x);var I=String(r.apply(void 0,A))}else I=s(y,c,E,S,x,r);E>=b&&(g+=c.slice(b,E)+I,b=E+y.length)}return g+c.slice(b)}];function s(e,n,r,o,i,a){var s=r+e.length,l=o.length,u=Mn;return void 0!==i&&(i=Re(i),u=In),t.call(a,u,(function(t,a){var u;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(s);case"<":u=i[a.slice(1,-1)];break;default:var c=+a;if(0===c)return t;if(c>l){var d=Cn(c/10);return 0===d?t:d<=l?void 0===o[d-1]?a.charAt(1):o[d-1]+a.charAt(1):t}u=o[c-1]}return void 0===u?"":u}))}}));for(var Tn in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Nn=r[Tn],kn=Nn&&Nn.prototype;if(kn&&kn.forEach!==Nt)try{T(kn,"forEach",Nt)}catch(e){kn.forEach=Nt}}function On(e){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Dn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pn(e,t){var n=e.__state.conversionName.toString(),r=Math.round(e.r),o=Math.round(e.g),i=Math.round(e.b),a=e.a,s=Math.round(e.h),l=e.s.toFixed(1),u=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=e.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+r+","+o+","+i+")":"CSS_RGBA"===n?"rgba("+r+","+o+","+i+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+r+","+o+","+i+"]":"RGBA_ARRAY"===n?"["+r+","+o+","+i+","+a+"]":"RGB_OBJ"===n?"{r:"+r+",g:"+o+",b:"+i+"}":"RGBA_OBJ"===n?"{r:"+r+",g:"+o+",b:"+i+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+u+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+u+",a:"+a+"}":"unknown format"}var Ln=Array.prototype.forEach,Hn=Array.prototype.slice,Gn={BREAK:{},extend:function(e){return this.each(Hn.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))}),this),e},defaults:function(e){return this.each(Hn.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))}),this),e},compose:function(){var e=Hn.call(arguments);return function(){for(var t=Hn.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(e)if(Ln&&e.forEach&&e.forEach===Ln)e.forEach(t,n);else if(e.length===e.length+0){var r,o=void 0;for(o=0,r=e.length;o<r;o++)if(o in e&&t.call(n,e[o],o)===this.BREAK)return}else for(var i in e)if(t.call(n,e[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var r=void 0;return function(){var o=this,i=arguments;function a(){r=null,n||e.apply(o,i)}var s=n||!r;clearTimeout(r),r=setTimeout(a,t),s&&e.apply(o,i)}},toArray:function(e){return e.toArray?e.toArray():Hn.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},Bn=[{litmus:Gn.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:Pn},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:Pn},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:Pn},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:Pn}}},{litmus:Gn.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:Gn.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:Gn.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(Gn.isNumber(e.r)&&Gn.isNumber(e.g)&&Gn.isNumber(e.b)&&Gn.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(Gn.isNumber(e.r)&&Gn.isNumber(e.g)&&Gn.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(Gn.isNumber(e.h)&&Gn.isNumber(e.s)&&Gn.isNumber(e.v)&&Gn.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(Gn.isNumber(e.h)&&Gn.isNumber(e.s)&&Gn.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],jn=void 0,Fn=void 0,Vn=function(){Fn=!1;var e=arguments.length>1?Gn.toArray(arguments):arguments[0];return Gn.each(Bn,(function(t){if(t.litmus(e))return Gn.each(t.conversions,(function(t,n){if(jn=t.read(e),!1===Fn&&!1!==jn)return Fn=jn,jn.conversionName=n,jn.conversion=t,Gn.BREAK})),Gn.BREAK})),Fn},zn=void 0,Un={hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),i=n*(1-t),a=n*(1-o*t),s=n*(1-(1-o)*t),l=[[n,s,i],[a,n,i],[i,n,s],[i,a,n],[s,i,n],[n,i,a]][r];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,n){var r=Math.min(e,t,n),o=Math.max(e,t,n),i=o-r,a=void 0;return 0===o?{h:NaN,s:0,v:0}:(a=e===o?(t-n)/i:t===o?2+(n-e)/i:4+(e-t)/i,(a/=6)<0&&(a+=1),{h:360*a,s:i/o,v:o/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(zn=8*t)|e&~(255<<zn)}},Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kn=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Wn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Xn=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},qn=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Jn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},$n=function(){function e(){if(Kn(this,e),this.__state=Vn.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Wn(e,[{key:"toString",value:function(){return Pn(this)}},{key:"toHexString",value:function(){return Pn(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function Qn(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||$n.recalculateRGB(this,t,n),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&($n.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function Zn(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||$n.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&($n.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}$n.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=Un.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");Gn.extend(e.__state,Un.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},$n.recalculateHSV=function(e){var t=Un.rgb_to_hsv(e.r,e.g,e.b);Gn.extend(e.__state,{s:t.s,v:t.v}),Gn.isNaN(t.h)?Gn.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},$n.COMPONENTS=["r","g","b","h","s","v","hex","a"],Qn($n.prototype,"r",2),Qn($n.prototype,"g",1),Qn($n.prototype,"b",0),Zn($n.prototype,"h"),Zn($n.prototype,"s"),Zn($n.prototype,"v"),Object.defineProperty($n.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty($n.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=Un.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var er=function(){function e(t,n){Kn(this,e),this.initialValue=t[n],this.domElement=document.createElement("div"),this.object=t,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return Wn(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),tr={};Gn.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(e,t){Gn.each(e,(function(e){tr[e]=t}))}));var nr=/(\d+(\.\d+)?)px/;function rr(e){if("0"===e||Gn.isUndefined(e))return 0;var t=e.match(nr);return Gn.isNull(t)?0:parseFloat(t[1])}var or={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var r=n,o=t;Gn.isUndefined(o)&&(o=!0),Gn.isUndefined(r)&&(r=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,r){var o=n||{},i=tr[t];if(!i)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(i);switch(i){case"MouseEvents":var s=o.x||o.clientX||0,l=o.y||o.clientY||0;a.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,s,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var u=a.initKeyboardEvent||a.initKeyEvent;Gn.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),u(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break;default:a.initEvent(t,o.bubbles||!1,o.cancelable||!0)}Gn.defaults(a,r),e.dispatchEvent(a)},bind:function(e,t,n,r){var o=r||!1;return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,n),or},unbind:function(e,t,n,r){var o=r||!1;return e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,n),or},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return or},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),r=n.indexOf(t);-1!==r&&(n.splice(r,1),e.className=n.join(" "))}else e.className=void 0;return or},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return rr(t["border-left-width"])+rr(t["border-right-width"])+rr(t["padding-left"])+rr(t["padding-right"])+rr(t.width)},getHeight:function(e){var t=getComputedStyle(e);return rr(t["border-top-width"])+rr(t["border-bottom-width"])+rr(t["padding-top"])+rr(t["padding-bottom"])+rr(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},ir=function(e){function t(e,n){Kn(this,t);var r=Jn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),or.bind(r.__checkbox,"change",(function(){o.setValue(!o.__prev)}),!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return qn(t,e),Wn(t,[{key:"setValue",value:function(e){var n=Xn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Xn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(er),ar=function(e){function t(e,n,r){Kn(this,t);var o=Jn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=r,a=o;if(o.__select=document.createElement("select"),Gn.isArray(i)){var s={};Gn.each(i,(function(e){s[e]=e})),i=s}return Gn.each(i,(function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)})),o.updateDisplay(),or.bind(o.__select,"change",(function(){var e=this.options[this.selectedIndex].value;a.setValue(e)})),o.domElement.appendChild(o.__select),o}return qn(t,e),Wn(t,[{key:"setValue",value:function(e){var n=Xn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return or.isActive(this.__select)?this:(this.__select.value=this.getValue(),Xn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(er),sr=function(e){function t(e,n){Kn(this,t);var r=Jn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;function i(){o.setValue(o.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),or.bind(r.__input,"keyup",i),or.bind(r.__input,"change",i),or.bind(r.__input,"blur",(function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())})),or.bind(r.__input,"keydown",(function(e){13===e.keyCode&&this.blur()})),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return qn(t,e),Wn(t,[{key:"updateDisplay",value:function(){return or.isActive(this.__input)||(this.__input.value=this.getValue()),Xn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(er);function lr(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var ur=function(e){function t(e,n,r){Kn(this,t);var o=Jn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=r||{};return o.__min=i.min,o.__max=i.max,o.__step=i.step,Gn.isUndefined(o.__step)?0===o.initialValue?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=lr(o.__impliedStep),o}return qn(t,e),Wn(t,[{key:"setValue",value:function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),Xn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=lr(e),this}}]),t}(er);var cr=function(e){function t(e,n,r){Kn(this,t);var o=Jn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));o.__truncationSuspended=!1;var i=o,a=void 0;function s(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}function l(e){var t=a-e.clientY;i.setValue(i.getValue()+t*i.__impliedStep),a=e.clientY}function u(){or.unbind(window,"mousemove",l),or.unbind(window,"mouseup",u),s()}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),or.bind(o.__input,"change",(function(){var e=parseFloat(i.__input.value);Gn.isNaN(e)||i.setValue(e)})),or.bind(o.__input,"blur",(function(){s()})),or.bind(o.__input,"mousedown",(function(e){or.bind(window,"mousemove",l),or.bind(window,"mouseup",u),a=e.clientY})),or.bind(o.__input,"keydown",(function(e){13===e.keyCode&&(i.__truncationSuspended=!0,this.blur(),i.__truncationSuspended=!1,s())})),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return qn(t,e),Wn(t,[{key:"updateDisplay",value:function(){var e,n,r;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),n=this.__precision,r=Math.pow(10,n),Math.round(e*r)/r),Xn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(ur);function dr(e,t,n,r,o){return r+(e-t)/(n-t)*(o-r)}var fr=function(e){function t(e,n,r,o,i){Kn(this,t);var a=Jn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:r,max:o,step:i})),s=a;function l(e){e.preventDefault();var t=s.__background.getBoundingClientRect();return s.setValue(dr(e.clientX,t.left,t.right,s.__min,s.__max)),!1}function u(){or.unbind(window,"mousemove",l),or.unbind(window,"mouseup",u),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function c(e){var t=e.touches[0].clientX,n=s.__background.getBoundingClientRect();s.setValue(dr(t,n.left,n.right,s.__min,s.__max))}function d(){or.unbind(window,"touchmove",c),or.unbind(window,"touchend",d),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),or.bind(a.__background,"mousedown",(function(e){document.activeElement.blur(),or.bind(window,"mousemove",l),or.bind(window,"mouseup",u),l(e)})),or.bind(a.__background,"touchstart",(function(e){if(1!==e.touches.length)return;or.bind(window,"touchmove",c),or.bind(window,"touchend",d),c(e)})),or.addClass(a.__background,"slider"),or.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return qn(t,e),Wn(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",Xn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(ur),hr=function(e){function t(e,n,r){Kn(this,t);var o=Jn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o;return o.__button=document.createElement("div"),o.__button.innerHTML=void 0===r?"Fire":r,or.bind(o.__button,"click",(function(e){return e.preventDefault(),i.fire(),!1})),or.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return qn(t,e),Wn(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(er),pr=function(e){function t(e,n){Kn(this,t);var r=Jn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.__color=new $n(r.getValue()),r.__temp=new $n(0);var o=r;r.domElement=document.createElement("div"),or.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",or.bind(r.__input,"keydown",(function(e){13===e.keyCode&&d.call(this)})),or.bind(r.__input,"blur",d),or.bind(r.__selector,"mousedown",(function(){or.addClass(this,"drag").bind(window,"mouseup",(function(){or.removeClass(o.__selector,"drag")}))})),or.bind(r.__selector,"touchstart",(function(){or.addClass(this,"drag").bind(window,"touchend",(function(){or.removeClass(o.__selector,"drag")}))}));var i,a=document.createElement("div");function s(e){h(e),or.bind(window,"mousemove",h),or.bind(window,"touchmove",h),or.bind(window,"mouseup",u),or.bind(window,"touchend",u)}function l(e){p(e),or.bind(window,"mousemove",p),or.bind(window,"touchmove",p),or.bind(window,"mouseup",c),or.bind(window,"touchend",c)}function u(){or.unbind(window,"mousemove",h),or.unbind(window,"touchmove",h),or.unbind(window,"mouseup",u),or.unbind(window,"touchend",u),f()}function c(){or.unbind(window,"mousemove",p),or.unbind(window,"touchmove",p),or.unbind(window,"mouseup",c),or.unbind(window,"touchend",c),f()}function d(){var e=Vn(this.value);!1!==e?(o.__color.__state=e,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function f(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function h(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,r=n.clientX,i=n.clientY,a=(r-t.left)/(t.right-t.left),s=1-(i-t.top)/(t.bottom-t.top);return s>1?s=1:s<0&&(s=0),a>1?a=1:a<0&&(a=0),o.__color.v=s,o.__color.s=a,o.setValue(o.__color.toOriginal()),!1}function p(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__hue_field.getBoundingClientRect(),n=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return n>1?n=1:n<0&&(n=0),o.__color.h=360*n,o.setValue(o.__color.toOriginal()),!1}return Gn.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Gn.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Gn.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Gn.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Gn.extend(a.style,{width:"100%",height:"100%",background:"none"}),mr(a,"top","rgba(0,0,0,0)","#000"),Gn.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(i=r.__hue_field).style.background="",i.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",i.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Gn.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),or.bind(r.__saturation_field,"mousedown",s),or.bind(r.__saturation_field,"touchstart",s),or.bind(r.__field_knob,"mousedown",s),or.bind(r.__field_knob,"touchstart",s),or.bind(r.__hue_field,"mousedown",l),or.bind(r.__hue_field,"touchstart",l),r.__saturation_field.appendChild(a),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay(),r}return qn(t,e),Wn(t,[{key:"updateDisplay",value:function(){var e=Vn(this.getValue());if(!1!==e){var t=!1;Gn.each($n.COMPONENTS,(function(n){if(!Gn.isUndefined(e[n])&&!Gn.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}}),this),t&&Gn.extend(this.__color.__state,e)}Gn.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,r=255-n;Gn.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,mr(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Gn.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})}}]),t}(er),_r=["-moz-","-o-","-webkit-","-ms-",""];function mr(e,t,n,r){e.style.background="",Gn.each(_r,(function(o){e.style.cssText+="background: "+o+"linear-gradient("+t+", "+n+" 0%, "+r+" 100%); "}))}var gr=function(e,t){var n=t||document,r=document.createElement("style");r.type="text/css",r.innerHTML=e;var o=n.getElementsByTagName("head")[0];try{o.appendChild(r)}catch(e){}},br='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',vr=function(e,t){var n=e[t];return Gn.isArray(arguments[2])||Gn.isObject(arguments[2])?new ar(e,t,arguments[2]):Gn.isNumber(n)?Gn.isNumber(arguments[2])&&Gn.isNumber(arguments[3])?Gn.isNumber(arguments[4])?new fr(e,t,arguments[2],arguments[3],arguments[4]):new fr(e,t,arguments[2],arguments[3]):Gn.isNumber(arguments[4])?new cr(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new cr(e,t,{min:arguments[2],max:arguments[3]}):Gn.isString(n)?new sr(e,t):Gn.isFunction(n)?new hr(e,t,""):Gn.isBoolean(n)?new ir(e,t):null};var yr=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},Er=function(){function e(){Kn(this,e),this.backgroundElement=document.createElement("div"),Gn.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),or.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Gn.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;or.bind(this.backgroundElement,"click",(function(){t.hide()}))}return Wn(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Gn.defer((function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",or.unbind(e.domElement,"webkitTransitionEnd",t),or.unbind(e.domElement,"transitionend",t),or.unbind(e.domElement,"oTransitionEnd",t)};or.bind(this.domElement,"webkitTransitionEnd",t),or.bind(this.domElement,"transitionend",t),or.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-or.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-or.getHeight(this.domElement)/2+"px"}}]),e}();gr(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var Sr=function(){try{return!!window.localStorage}catch(e){return!1}}(),wr=void 0,xr=!0,Ar=void 0,Cr=!1,Ir=[],Mr=function e(t){var n=this,r=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),or.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=Gn.defaults(r,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),r=Gn.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),Gn.isUndefined(r.load)?r.load={preset:"Default"}:r.preset&&(r.load.preset=r.preset),Gn.isUndefined(r.parent)&&r.hideable&&Ir.push(this),r.resizable=Gn.isUndefined(r.parent)&&r.resizable,r.autoPlace&&Gn.isUndefined(r.scrollable)&&(r.scrollable=!0);var o,i=Sr&&"true"===localStorage.getItem(Dr(this,"isLocal")),a=void 0,s=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:r.load.preset},set:function(e){n.parent?n.getRoot().preset=e:r.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return r.width},set:function(e){r.width=e,Br(n,e)}},name:{get:function(){return r.name},set:function(e){r.name=e,s&&(s.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(t){r.closed=t,r.closed?or.addClass(n.__ul,e.CLASS_CLOSED):or.removeClass(n.__ul,e.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return i},set:function(e){Sr&&(i=e,e?or.bind(window,"unload",a):or.unbind(window,"unload",a),localStorage.setItem(Dr(n,"isLocal"),e))}}}),Gn.isUndefined(r.parent)){if(this.closed=r.closed||!1,or.addClass(this.domElement,e.CLASS_MAIN),or.makeSelectable(this.domElement,!1),Sr&&i){n.useLocalStorage=!0;var l=localStorage.getItem(Dr(this,"gui"));l&&(r.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,or.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),r.closeOnTop?(or.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(or.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),or.bind(this.__closeButton,"click",(function(){n.closed=!n.closed}))}else{void 0===r.closed&&(r.closed=!0);var u=document.createTextNode(r.name);or.addClass(u,"controller-name"),s=Tr(n,u);or.addClass(this.__ul,e.CLASS_CLOSED),or.addClass(s,"title"),or.bind(s,"click",(function(e){return e.preventDefault(),n.closed=!n.closed,!1})),r.closed||(this.closed=!1)}r.autoPlace&&(Gn.isUndefined(r.parent)&&(xr&&(Ar=document.createElement("div"),or.addClass(Ar,"dg"),or.addClass(Ar,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Ar),xr=!1),Ar.appendChild(this.domElement),or.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||Br(n,r.width)),this.__resizeHandler=function(){n.onResizeDebounced()},or.bind(window,"resize",this.__resizeHandler),or.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),or.bind(this.__ul,"transitionend",this.__resizeHandler),or.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&Gr(this),a=function(){Sr&&"true"===localStorage.getItem(Dr(n,"isLocal"))&&localStorage.setItem(Dr(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=a,r.parent||((o=n.getRoot()).width+=1,Gn.defer((function(){o.width-=1})))};function Tr(e,t,n){var r=document.createElement("li");return t&&r.appendChild(t),n?e.__ul.insertBefore(r,n):e.__ul.appendChild(r),e.onResize(),r}function Nr(e){or.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&or.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function kr(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function Or(e,t){var n=e.getRoot(),r=n.__rememberedObjects.indexOf(t.object);if(-1!==r){var o=n.__rememberedObjectIndecesToControllers[r];if(void 0===o&&(o={},n.__rememberedObjectIndecesToControllers[r]=o),o[t.property]=t,n.load&&n.load.remembered){var i=n.load.remembered,a=void 0;if(i[e.preset])a=i[e.preset];else{if(!i.Default)return;a=i.Default}if(a[r]&&void 0!==a[r][t.property]){var s=a[r][t.property];t.initialValue=s,t.setValue(s)}}}}function Rr(e,t,n,r){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var o=void 0;if(r.color)o=new pr(t,n);else{var i=[t,n].concat(r.factoryArgs);o=vr.apply(e,i)}r.before instanceof er&&(r.before=r.before.__li),Or(e,o),or.addClass(o.domElement,"c");var a=document.createElement("span");or.addClass(a,"property-name"),a.innerHTML=o.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(o.domElement);var l=Tr(e,s,r.before);return or.addClass(l,Mr.CLASS_CONTROLLER_ROW),o instanceof pr?or.addClass(l,"color"):or.addClass(l,Yn(o.getValue())),function(e,t,n){if(n.__li=t,n.__gui=e,Gn.extend(n,{options:function(t){if(arguments.length>1){var r=n.__li.nextElementSibling;return n.remove(),Rr(e,n.object,n.property,{before:r,factoryArgs:[Gn.toArray(arguments)]})}if(Gn.isArray(t)||Gn.isObject(t)){var o=n.__li.nextElementSibling;return n.remove(),Rr(e,n.object,n.property,{before:o,factoryArgs:[t]})}},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof fr){var r=new cr(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});Gn.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(e){var t=n[e],o=r[e];n[e]=r[e]=function(){var e=Array.prototype.slice.call(arguments);return o.apply(r,e),t.apply(n,e)}})),or.addClass(t,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof cr){var o=function(t){if(Gn.isNumber(n.__min)&&Gn.isNumber(n.__max)){var r=n.__li.firstElementChild.firstElementChild.innerHTML,o=n.__gui.__listening.indexOf(n)>-1;n.remove();var i=Rr(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return i.name(r),o&&i.listen(),i}return t};n.min=Gn.compose(o,n.min),n.max=Gn.compose(o,n.max)}else n instanceof ir?(or.bind(t,"click",(function(){or.fakeEvent(n.__checkbox,"click")})),or.bind(n.__checkbox,"click",(function(e){e.stopPropagation()}))):n instanceof hr?(or.bind(t,"click",(function(){or.fakeEvent(n.__button,"click")})),or.bind(t,"mouseover",(function(){or.addClass(n.__button,"hover")})),or.bind(t,"mouseout",(function(){or.removeClass(n.__button,"hover")}))):n instanceof pr&&(or.addClass(t,"color"),n.updateDisplay=Gn.compose((function(e){return t.style.borderLeftColor=n.__color.toString(),e}),n.updateDisplay),n.updateDisplay());n.setValue=Gn.compose((function(t){return e.getRoot().__preset_select&&n.isModified()&&kr(e.getRoot(),!0),t}),n.setValue)}(e,l,o),e.__controllers.push(o),o}function Dr(e,t){return document.location.href+"."+t}function Pr(e,t,n){var r=document.createElement("option");r.innerHTML=t,r.value=t,e.__preset_select.appendChild(r),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function Lr(e,t){t.style.display=e.useLocalStorage?"block":"none"}function Hr(e){var t=e.__save_row=document.createElement("li");or.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),or.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",or.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",or.addClass(r,"button"),or.addClass(r,"save");var o=document.createElement("span");o.innerHTML="New",or.addClass(o,"button"),or.addClass(o,"save-as");var i=document.createElement("span");i.innerHTML="Revert",or.addClass(i,"button"),or.addClass(i,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?Gn.each(e.load.remembered,(function(t,n){Pr(e,n,n===e.preset)})):Pr(e,"Default",!1),or.bind(a,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value})),t.appendChild(a),t.appendChild(n),t.appendChild(r),t.appendChild(o),t.appendChild(i),Sr){var s=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(Dr(0,"isLocal"))&&l.setAttribute("checked","checked"),Lr(e,s),or.bind(l,"change",(function(){e.useLocalStorage=!e.useLocalStorage,Lr(e,s)}))}var u=document.getElementById("dg-new-constructor");or.bind(u,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||wr.hide()})),or.bind(n,"click",(function(){u.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),wr.show(),u.focus(),u.select()})),or.bind(r,"click",(function(){e.save()})),or.bind(o,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)})),or.bind(i,"click",(function(){e.revert()}))}function Gr(e){var t=void 0;function n(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function r(){or.removeClass(e.__closeButton,Mr.CLASS_DRAG),or.unbind(window,"mousemove",n),or.unbind(window,"mouseup",r)}function o(o){return o.preventDefault(),t=o.clientX,or.addClass(e.__closeButton,Mr.CLASS_DRAG),or.bind(window,"mousemove",n),or.bind(window,"mouseup",r),!1}e.__resize_handle=document.createElement("div"),Gn.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),or.bind(e.__resize_handle,"mousedown",o),or.bind(e.__closeButton,"mousedown",o),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function Br(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function jr(e,t){var n={};return Gn.each(e.__rememberedObjects,(function(r,o){var i={},a=e.__rememberedObjectIndecesToControllers[o];Gn.each(a,(function(e,n){i[n]=t?e.initialValue:e.getValue()})),n[o]=i})),n}Mr.toggleHide=function(){Cr=!Cr,Gn.each(Ir,(function(e){e.domElement.style.display=Cr?"none":""}))},Mr.CLASS_AUTO_PLACE="a",Mr.CLASS_AUTO_PLACE_CONTAINER="ac",Mr.CLASS_MAIN="main",Mr.CLASS_CONTROLLER_ROW="cr",Mr.CLASS_TOO_TALL="taller-than-window",Mr.CLASS_CLOSED="closed",Mr.CLASS_CLOSE_BUTTON="close-button",Mr.CLASS_CLOSE_TOP="close-top",Mr.CLASS_CLOSE_BOTTOM="close-bottom",Mr.CLASS_DRAG="drag",Mr.DEFAULT_WIDTH=245,Mr.TEXT_CLOSED="Close Controls",Mr.TEXT_OPEN="Open Controls",Mr._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||Mr.toggleHide()},or.bind(window,"keydown",Mr._keydownHandler,!1),Gn.extend(Mr.prototype,{add:function(e,t){return Rr(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Rr(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;Gn.defer((function(){t.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Ar.removeChild(this.domElement);var e=this;Gn.each(this.__folders,(function(t){e.removeFolder(t)})),or.unbind(window,"keydown",Mr._keydownHandler,!1),Nr(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new Mr(t);this.__folders[e]=n;var r=Tr(this,n.domElement);return or.addClass(r,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],Nr(e);var t=this;Gn.each(e.__folders,(function(t){e.removeFolder(t)})),Gn.defer((function(){t.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=or.getOffset(e.__ul).top,n=0;Gn.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(n+=or.getHeight(t))})),window.innerHeight-t-20<n?(or.addClass(e.domElement,Mr.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(or.removeClass(e.domElement,Mr.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&Gn.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:Gn.debounce((function(){this.onResize()}),50),remember:function(){if(Gn.isUndefined(wr)&&((wr=new Er).domElement.innerHTML=br),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;Gn.each(Array.prototype.slice.call(arguments),(function(t){0===e.__rememberedObjects.length&&Hr(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)})),this.autoPlace&&Br(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=jr(this)),e.folders={},Gn.each(this.__folders,(function(t,n){e.folders[n]=t.getSaveObject()})),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=jr(this),kr(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=jr(this,!0)),this.load.remembered[e]=jr(this),this.preset=e,Pr(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){Gn.each(this.__controllers,(function(t){this.getRoot().load.remembered?Or(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this),Gn.each(this.__folders,(function(e){e.revert(e)})),e||kr(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&yr.call(window,(function(){e(t)}));Gn.each(t,(function(e){e.updateDisplay()}))}(this.__listening)},updateDisplay:function(){Gn.each(this.__controllers,(function(e){e.updateDisplay()})),Gn.each(this.__folders,(function(e){e.updateDisplay()}))}});var Fr={color:{Color:$n,math:Un,interpret:Vn},controllers:{Controller:er,BooleanController:ir,OptionController:ar,StringController:sr,NumberController:ur,NumberControllerBox:cr,NumberControllerSlider:fr,FunctionController:hr,ColorController:pr},dom:{dom:or},gui:{GUI:Mr},GUI:Mr},Vr=t((function(t){!function(e){function n(){if(n.prototype._singleton)throw new Error("WebMidi is a singleton, it cannot be instantiated directly.");(n.prototype._singleton=this)._inputs=[],this._outputs=[],this._userHandlers={},this._stateChangeQueue=[],this._processingStateChange=!1,this._midiInterfaceEvents=["connected","disconnected"],this._nrpnBuffer=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],this._nrpnEventsEnabled=!0,this._nrpnTypes=["entry","increment","decrement"],this._notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this._semitones={C:0,D:2,E:4,F:5,G:7,A:9,B:11},Object.defineProperties(this,{MIDI_SYSTEM_MESSAGES:{value:{sysex:240,timecode:241,songposition:242,songselect:243,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MESSAGES:{value:{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,channelmode:11,nrpn:11,programchange:12,channelaftertouch:13,pitchbend:14},writable:!1,enumerable:!0,configurable:!1},MIDI_REGISTERED_PARAMETER:{value:{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]},writable:!1,enumerable:!0,configurable:!1},MIDI_CONTROL_CHANGE_MESSAGES:{value:{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101},writable:!1,enumerable:!0,configurable:!1},MIDI_NRPN_MESSAGES:{value:{entrymsb:6,entrylsb:38,increment:96,decrement:97,paramlsb:98,parammsb:99,nullactiveparameter:127},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MODE_MESSAGES:{value:{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127},writable:!1,enumerable:!0,configurable:!1},octaveOffset:{value:0,writable:!0,enumerable:!0,configurable:!1}}),Object.defineProperties(this,{supported:{enumerable:!0,get:function(){return"requestMIDIAccess"in navigator}},enabled:{enumerable:!0,get:function(){return void 0!==this.interface}.bind(this)},inputs:{enumerable:!0,get:function(){return this._inputs}.bind(this)},outputs:{enumerable:!0,get:function(){return this._outputs}.bind(this)},sysexEnabled:{enumerable:!0,get:function(){return!(!this.interface||!this.interface.sysexEnabled)}.bind(this)},nrpnEventsEnabled:{enumerable:!0,get:function(){return!!this._nrpnEventsEnabled}.bind(this),set:function(e){return this._nrpnEventsEnabled=e,this._nrpnEventsEnabled}},nrpnTypes:{enumerable:!0,get:function(){return this._nrpnTypes}.bind(this)},time:{enumerable:!0,get:function(){return performance.now()}}})}var r=new n;function o(e){var t=this;this._userHandlers={channel:{},system:{}},this._midiInput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiInput.connection}},id:{enumerable:!0,get:function(){return t._midiInput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiInput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiInput.name}},state:{enumerable:!0,get:function(){return t._midiInput.state}},type:{enumerable:!0,get:function(){return t._midiInput.type}}}),this._initializeUserHandlers(),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}function i(e){var t=this;this._midiOutput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiOutput.connection}},id:{enumerable:!0,get:function(){return t._midiOutput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiOutput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiOutput.name}},state:{enumerable:!0,get:function(){return t._midiOutput.state}},type:{enumerable:!0,get:function(){return t._midiOutput.type}}})}n.prototype.enable=function(e,t){this.enabled||(this.supported?navigator.requestMIDIAccess({sysex:t}).then(function(t){var n,r=[],o=[];this.interface=t,this._resetInterfaceUserHandlers(),this.interface.onstatechange=function(e){r.push(e)};for(var i=t.inputs.values(),a=i.next();a&&!a.done;a=i.next())o.push(a.value.open());for(var s=t.outputs.values(),l=s.next();l&&!l.done;l=s.next())o.push(l.value.open());function u(){clearTimeout(n),this._updateInputsAndOutputs(),this.interface.onstatechange=this._onInterfaceStateChange.bind(this),"function"==typeof e&&e.call(this),r.forEach(function(e){this._onInterfaceStateChange(e)}.bind(this))}n=setTimeout(u.bind(this),200),Promise&&Promise.all(o).catch((function(e){})).then(u.bind(this))}.bind(this),function(t){"function"==typeof e&&e.call(this,t)}.bind(this)):"function"==typeof e&&e(new Error("The Web MIDI API is not supported by your browser.")))},n.prototype.disable=function(){if(!this.supported)throw new Error("The Web MIDI API is not supported by your browser.");this.interface&&(this.interface.onstatechange=void 0),this.interface=void 0,this._inputs=[],this._outputs=[],this._nrpnEventsEnabled=!0,this._resetInterfaceUserHandlers()},n.prototype.addListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before adding event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");return this._userHandlers[e].push(t),this},n.prototype.hasListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before checking event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");for(var n=0;n<this._userHandlers[e].length;n++)if(this._userHandlers[e][n]===t)return!0;return!1},n.prototype.removeListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before removing event listeners.");if(void 0!==t&&"function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(0<=this._midiInterfaceEvents.indexOf(e))if(t)for(var n=0;n<this._userHandlers[e].length;n++)this._userHandlers[e][n]===t&&this._userHandlers[e].splice(n,1);else this._userHandlers[e]=[];else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._resetInterfaceUserHandlers()}return this},n.prototype.toMIDIChannels=function(e){var t;if("all"===e||void 0===e)t=["all"];else{if("none"===e)return[];t=Array.isArray(e)?e:[e]}return-1<t.indexOf("all")&&(t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),t.map((function(e){return parseInt(e)})).filter((function(e){return 1<=e&&e<=16}))},n.prototype.getInputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.inputs.length;t++)if(this.inputs[t].id===e)return this.inputs[t];return!1},n.prototype.getOutputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.outputs.length;t++)if(this.outputs[t].id===e)return this.outputs[t];return!1},n.prototype.getInputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.inputs.length;t++)if(~this.inputs[t].name.indexOf(e))return this.inputs[t];return!1},n.prototype.getOctave=function(e){if(null!=e&&0<=e&&e<=127)return Math.floor(Math.floor(e)/12-1)+Math.floor(r.octaveOffset)},n.prototype.getOutputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.outputs.length;t++)if(~this.outputs[t].name.indexOf(e))return this.outputs[t];return!1},n.prototype.guessNoteNumber=function(e){var t=!1;if(e&&e.toFixed&&0<=e&&e<=127?t=Math.round(e):0<=parseInt(e)&&parseInt(e)<=127?t=parseInt(e):("string"==typeof e||e instanceof String)&&(t=this.noteNameToNumber(e)),!1===t)throw new Error("Invalid input value ("+e+").");return t},n.prototype.noteNameToNumber=function(e){"string"!=typeof e&&(e="");var t=e.match(/([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)/i);if(!t)throw new RangeError("Invalid note name.");var n=r._semitones[t[1].toUpperCase()],o=12*(parseInt(t[3])+1-Math.floor(r.octaveOffset))+n;if(-1<t[2].toLowerCase().indexOf("b")?o-=t[2].length:-1<t[2].toLowerCase().indexOf("#")&&(o+=t[2].length),o<0||127<o)throw new RangeError("Invalid note name or note outside valid range.");return o},n.prototype._updateInputsAndOutputs=function(){this._updateInputs(),this._updateOutputs()},n.prototype._updateInputs=function(){for(var e=0;e<this._inputs.length;e++){for(var t=!0,n=this.interface.inputs.values(),r=n.next();r&&!r.done;r=n.next())if(this._inputs[e]._midiInput===r.value){t=!1;break}t&&this._inputs.splice(e,1)}this.interface&&this.interface.inputs.forEach(function(e){for(var t=!0,n=0;n<this._inputs.length;n++)this._inputs[n]._midiInput===e&&(t=!1);t&&this._inputs.push(new o(e))}.bind(this))},n.prototype._updateOutputs=function(){for(var e=0;e<this._outputs.length;e++){for(var t=!0,n=this.interface.outputs.values(),r=n.next();r&&!r.done;r=n.next())if(this._outputs[e]._midiOutput===r.value){t=!1;break}t&&this._outputs.splice(e,1)}this.interface&&this.interface.outputs.forEach(function(e){for(var t=!0,n=0;n<this._outputs.length;n++)this._outputs[n]._midiOutput===e&&(t=!1);t&&this._outputs.push(new i(e))}.bind(this))},n.prototype._onInterfaceStateChange=function(e){this._updateInputsAndOutputs();var t={timestamp:e.timeStamp,type:e.port.state};this.interface&&"connected"===e.port.state?"output"===e.port.type?t.port=this.getOutputById(e.port.id):"input"===e.port.type&&(t.port=this.getInputById(e.port.id)):t.port={connection:"closed",id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this._userHandlers[e.port.state].forEach((function(e){e(t)}))},n.prototype._resetInterfaceUserHandlers=function(){for(var e=0;e<this._midiInterfaceEvents.length;e++)this._userHandlers[this._midiInterfaceEvents[e]]=[]},o.prototype.on=o.prototype.addListener=function(e,t,n){var o=this;if(void 0===t&&(t="all"),Array.isArray(t)||(t=[t]),t.forEach((function(e){if("all"!==e&&!(1<=e&&e<=16))throw new RangeError("The 'channel' parameter is invalid.")})),"function"!=typeof n)throw new TypeError("The 'listener' parameter must be a function.");if(void 0!==r.MIDI_SYSTEM_MESSAGES[e])this._userHandlers.system[e]||(this._userHandlers.system[e]=[]),this._userHandlers.system[e].push(n);else{if(void 0===r.MIDI_CHANNEL_MESSAGES[e])throw new TypeError("The specified event type is not supported.");if(-1<t.indexOf("all")){t=[];for(var i=1;i<=16;i++)t.push(i)}this._userHandlers.channel[e]||(this._userHandlers.channel[e]=[]),t.forEach((function(t){o._userHandlers.channel[e][t]||(o._userHandlers.channel[e][t]=[]),o._userHandlers.channel[e][t].push(n)}))}return this},o.prototype.hasListener=function(e,t,n){var o=this;if("function"!=typeof n)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==r.MIDI_SYSTEM_MESSAGES[e]){for(var i=0;i<this._userHandlers.system[e].length;i++)if(this._userHandlers.system[e][i]===n)return!0}else if(void 0!==r.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var a=1;a<=16;a++)t.push(a)}return!!this._userHandlers.channel[e]&&t.every((function(t){var r=o._userHandlers.channel[e][t];return r&&-1<r.indexOf(n)}))}return!1},o.prototype.removeListener=function(e,t,n){var o=this;if(void 0!==n&&"function"!=typeof n)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==r.MIDI_SYSTEM_MESSAGES[e])if(void 0===n)this._userHandlers.system[e]=[];else for(var i=0;i<this._userHandlers.system[e].length;i++)this._userHandlers.system[e][i]===n&&this._userHandlers.system[e].splice(i,1);else if(void 0!==r.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var a=1;a<=16;a++)t.push(a)}if(!this._userHandlers.channel[e])return this;t.forEach((function(t){var r=o._userHandlers.channel[e][t];if(r)if(void 0===n)o._userHandlers.channel[e][t]=[];else for(var i=0;i<r.length;i++)r[i]===n&&r.splice(i,1)}))}else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._initializeUserHandlers()}return this},o.prototype._initializeUserHandlers=function(){for(var e in r.MIDI_CHANNEL_MESSAGES)r.MIDI_CHANNEL_MESSAGES.hasOwnProperty(e)&&(this._userHandlers.channel[e]={});for(var t in r.MIDI_SYSTEM_MESSAGES)r.MIDI_SYSTEM_MESSAGES.hasOwnProperty(t)&&(this._userHandlers.system[t]=[])},o.prototype._onMidiMessage=function(e){if(0<this._userHandlers.system.midimessage.length){var t={target:this,data:e.data,timestamp:e.timeStamp,type:"midimessage"};this._userHandlers.system.midimessage.forEach((function(e){e(t)}))}e.data[0]<240?(this._parseChannelEvent(e),this._parseNrpnEvent(e)):e.data[0]<=255&&this._parseSystemEvent(e)},o.prototype._parseNrpnEvent=function(e){var t,n,o=e.data[0]>>4,i=15&e.data[0],a=1+i;if(1<e.data.length&&(t=e.data[1],n=2<e.data.length?e.data[2]:void 0),r.nrpnEventsEnabled&&o===r.MIDI_CHANNEL_MESSAGES.controlchange&&(t>=r.MIDI_NRPN_MESSAGES.increment&&t<=r.MIDI_NRPN_MESSAGES.parammsb||t===r.MIDI_NRPN_MESSAGES.entrymsb||t===r.MIDI_NRPN_MESSAGES.entrylsb)){var s={target:this,type:"controlchange",data:e.data,timestamp:e.timeStamp,channel:a,controller:{number:t,name:this.getCcNameByNumber(t)},value:n};if(s.controller.number===r.MIDI_NRPN_MESSAGES.parammsb&&s.value!=r.MIDI_NRPN_MESSAGES.nullactiveparameter)r._nrpnBuffer[i]=[],r._nrpnBuffer[i][0]=s;else if(1===r._nrpnBuffer[i].length&&s.controller.number===r.MIDI_NRPN_MESSAGES.paramlsb)r._nrpnBuffer[i].push(s);else if(2!==r._nrpnBuffer[i].length||s.controller.number!==r.MIDI_NRPN_MESSAGES.increment&&s.controller.number!==r.MIDI_NRPN_MESSAGES.decrement&&s.controller.number!==r.MIDI_NRPN_MESSAGES.entrymsb)if(3===r._nrpnBuffer[i].length&&r._nrpnBuffer[i][2].number===r.MIDI_NRPN_MESSAGES.entrymsb&&s.controller.number===r.MIDI_NRPN_MESSAGES.entrylsb)r._nrpnBuffer[i].push(s);else if(3<=r._nrpnBuffer[i].length&&r._nrpnBuffer[i].length<=4&&s.controller.number===r.MIDI_NRPN_MESSAGES.parammsb&&s.value===r.MIDI_NRPN_MESSAGES.nullactiveparameter)r._nrpnBuffer[i].push(s);else if(4<=r._nrpnBuffer[i].length&&r._nrpnBuffer[i].length<=5&&s.controller.number===r.MIDI_NRPN_MESSAGES.paramlsb&&s.value===r.MIDI_NRPN_MESSAGES.nullactiveparameter){r._nrpnBuffer[i].push(s);var l=[];r._nrpnBuffer[i].forEach((function(e){l.push(e.data)}));var u=r._nrpnBuffer[i][0].value<<7|r._nrpnBuffer[i][1].value,c=r._nrpnBuffer[i][2].value;6===r._nrpnBuffer[i].length&&(c=r._nrpnBuffer[i][2].value<<7|r._nrpnBuffer[i][3].value);var d="";switch(r._nrpnBuffer[i][2].controller.number){case r.MIDI_NRPN_MESSAGES.entrymsb:d=r._nrpnTypes[0];break;case r.MIDI_NRPN_MESSAGES.increment:d=r._nrpnTypes[1];break;case r.MIDI_NRPN_MESSAGES.decrement:d=r._nrpnTypes[2];break;default:throw new Error("The NPRN type was unidentifiable.")}var f={timestamp:s.timestamp,channel:s.channel,type:"nrpn",data:l,controller:{number:u,type:d,name:"Non-Registered Parameter "+u},value:c};r._nrpnBuffer[i]=[],this._userHandlers.channel[f.type]&&this._userHandlers.channel[f.type][f.channel]&&this._userHandlers.channel[f.type][f.channel].forEach((function(e){e(f)}))}else r._nrpnBuffer[i]=[];else r._nrpnBuffer[i].push(s)}},o.prototype._parseChannelEvent=function(e){var t,n,o=e.data[0]>>4,i=1+(15&e.data[0]);1<e.data.length&&(t=e.data[1],n=2<e.data.length?e.data[2]:void 0);var a={target:this,data:e.data,timestamp:e.timeStamp,channel:i};o===r.MIDI_CHANNEL_MESSAGES.noteoff||o===r.MIDI_CHANNEL_MESSAGES.noteon&&0===n?(a.type="noteoff",a.note={number:t,name:r._notes[t%12],octave:r.getOctave(t)},a.velocity=n/127,a.rawVelocity=n):o===r.MIDI_CHANNEL_MESSAGES.noteon?(a.type="noteon",a.note={number:t,name:r._notes[t%12],octave:r.getOctave(t)},a.velocity=n/127,a.rawVelocity=n):o===r.MIDI_CHANNEL_MESSAGES.keyaftertouch?(a.type="keyaftertouch",a.note={number:t,name:r._notes[t%12],octave:r.getOctave(t)},a.value=n/127):o===r.MIDI_CHANNEL_MESSAGES.controlchange&&0<=t&&t<=119?(a.type="controlchange",a.controller={number:t,name:this.getCcNameByNumber(t)},a.value=n):o===r.MIDI_CHANNEL_MESSAGES.channelmode&&120<=t&&t<=127?(a.type="channelmode",a.controller={number:t,name:this.getChannelModeByNumber(t)},a.value=n):o===r.MIDI_CHANNEL_MESSAGES.programchange?(a.type="programchange",a.value=t):o===r.MIDI_CHANNEL_MESSAGES.channelaftertouch?(a.type="channelaftertouch",a.value=t/127):o===r.MIDI_CHANNEL_MESSAGES.pitchbend?(a.type="pitchbend",a.value=((n<<7)+t-8192)/8192):a.type="unknownchannelmessage",this._userHandlers.channel[a.type]&&this._userHandlers.channel[a.type][i]&&this._userHandlers.channel[a.type][i].forEach((function(e){e(a)}))},o.prototype.getCcNameByNumber=function(e){if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("The control change number must be between 0 and 119.");for(var t in r.MIDI_CONTROL_CHANGE_MESSAGES)if(r.MIDI_CONTROL_CHANGE_MESSAGES.hasOwnProperty(t)&&e===r.MIDI_CONTROL_CHANGE_MESSAGES[t])return t},o.prototype.getChannelModeByNumber=function(e){if(!(120<=(e=Math.floor(e))&&status<=127))throw new RangeError("The control change number must be between 120 and 127.");for(var t in r.MIDI_CHANNEL_MODE_MESSAGES)if(r.MIDI_CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===r.MIDI_CHANNEL_MODE_MESSAGES[t])return t},o.prototype._parseSystemEvent=function(e){var t=e.data[0],n={target:this,data:e.data,timestamp:e.timeStamp};t===r.MIDI_SYSTEM_MESSAGES.sysex?n.type="sysex":t===r.MIDI_SYSTEM_MESSAGES.timecode?n.type="timecode":t===r.MIDI_SYSTEM_MESSAGES.songposition?n.type="songposition":t===r.MIDI_SYSTEM_MESSAGES.songselect?(n.type="songselect",n.song=e.data[1]):t===r.MIDI_SYSTEM_MESSAGES.tuningrequest?n.type="tuningrequest":t===r.MIDI_SYSTEM_MESSAGES.clock?n.type="clock":t===r.MIDI_SYSTEM_MESSAGES.start?n.type="start":t===r.MIDI_SYSTEM_MESSAGES.continue?n.type="continue":t===r.MIDI_SYSTEM_MESSAGES.stop?n.type="stop":t===r.MIDI_SYSTEM_MESSAGES.activesensing?n.type="activesensing":t===r.MIDI_SYSTEM_MESSAGES.reset?n.type="reset":n.type="unknownsystemmessage",this._userHandlers.system[n.type]&&this._userHandlers.system[n.type].forEach((function(e){e(n)}))},i.prototype.send=function(e,t,n){if(!(128<=e&&e<=255))throw new RangeError("The status byte must be an integer between 128 (0x80) and 255 (0xFF).");void 0===t&&(t=[]),Array.isArray(t)||(t=[t]);var r=[];return t.forEach((function(e){var t=Math.floor(e);if(!(0<=t&&t<=255))throw new RangeError("Data bytes must be integers between 0 (0x00) and 255 (0xFF).");r.push(t)})),this._midiOutput.send([e].concat(r),parseFloat(n)||0),this},i.prototype.sendSysex=function(e,t,n){if(!r.sysexEnabled)throw new Error("Sysex message support must first be activated.");return n=n||{},e=[].concat(e),t.forEach((function(e){if(e<0||127<e)throw new RangeError("The data bytes of a sysex message must be integers between 0 (0x00) and 127 (0x7F).")})),t=e.concat(t,r.MIDI_SYSTEM_MESSAGES.sysexend),this.send(r.MIDI_SYSTEM_MESSAGES.sysex,t,this._parseTimeParameter(n.time)),this},i.prototype.sendTimecodeQuarterFrame=function(e,t){return t=t||{},this.send(r.MIDI_SYSTEM_MESSAGES.timecode,e,this._parseTimeParameter(t.time)),this},i.prototype.sendSongPosition=function(e,t){t=t||{};var n=(e=Math.floor(e)||0)>>7&127,o=127&e;return this.send(r.MIDI_SYSTEM_MESSAGES.songposition,[n,o],this._parseTimeParameter(t.time)),this},i.prototype.sendSongSelect=function(e,t){if(t=t||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The song number must be between 0 and 127.");return this.send(r.MIDI_SYSTEM_MESSAGES.songselect,[e],this._parseTimeParameter(t.time)),this},i.prototype.sendTuningRequest=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.tuningrequest,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendClock=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.clock,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendStart=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.start,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendContinue=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.continue,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendStop=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.stop,void 0,this._parseTimeParameter(e.time)),this},i.prototype.sendActiveSensing=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.activesensing,[],this._parseTimeParameter(e.time)),this},i.prototype.sendReset=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.reset,void 0,this._parseTimeParameter(e.time)),this},i.prototype.stopNote=function(e,t,n){if("all"===e)return this.sendChannelMode("allnotesoff",0,t,n);var o=64;return(n=n||{}).rawVelocity?!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=127&&(o=n.velocity):!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=1&&(o=127*n.velocity),this._convertNoteToArray(e).forEach(function(e){r.toMIDIChannels(t).forEach(function(t){this.send((r.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(o)],this._parseTimeParameter(n.time))}.bind(this))}.bind(this)),this},i.prototype.playNote=function(e,t,n){var o,i=64;if((n=n||{}).rawVelocity?!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=127&&(i=n.velocity):!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=1&&(i=127*n.velocity),o=this._parseTimeParameter(n.time),this._convertNoteToArray(e).forEach(function(e){r.toMIDIChannels(t).forEach(function(t){this.send((r.MIDI_CHANNEL_MESSAGES.noteon<<4)+(t-1),[e,Math.round(i)],o)}.bind(this))}.bind(this)),!isNaN(n.duration)){n.duration<=0&&(n.duration=0);var a=64;n.rawVelocity?!isNaN(n.release)&&0<=n.release&&n.release<=127&&(a=n.release):!isNaN(n.release)&&0<=n.release&&n.release<=1&&(a=127*n.release),this._convertNoteToArray(e).forEach(function(e){r.toMIDIChannels(t).forEach(function(t){this.send((r.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(a)],(o||r.time)+n.duration)}.bind(this))}.bind(this))}return this},i.prototype.sendKeyAftertouch=function(e,t,n,o){var i=this;if(o=o||{},t<1||16<t)throw new RangeError("The channel must be between 1 and 16.");(isNaN(n)||n<0||1<n)&&(n=.5);var a=Math.round(127*n);return this._convertNoteToArray(e).forEach((function(e){r.toMIDIChannels(t).forEach((function(t){i.send((r.MIDI_CHANNEL_MESSAGES.keyaftertouch<<4)+(t-1),[e,a],i._parseTimeParameter(o.time))}))})),this},i.prototype.sendControlChange=function(e,t,n,o){if(o=o||{},"string"==typeof e){if(void 0===(e=r.MIDI_CONTROL_CHANGE_MESSAGES[e]))throw new TypeError("Invalid controller name.")}else if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("Controller numbers must be between 0 and 119.");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("Controller value must be between 0 and 127.");return r.toMIDIChannels(n).forEach(function(n){this.send((r.MIDI_CHANNEL_MESSAGES.controlchange<<4)+(n-1),[e,t],this._parseTimeParameter(o.time))}.bind(this)),this},i.prototype._selectRegisteredParameter=function(e,t,n){var o=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control65 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control64 value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){o.sendControlChange(101,e[0],t,{time:n}),o.sendControlChange(100,e[1],t,{time:n})})),this},i.prototype._selectNonRegisteredParameter=function(e,t,n){var o=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control63 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control62 value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){o.sendControlChange(99,e[0],t,{time:n}),o.sendControlChange(98,e[1],t,{time:n})})),this},i.prototype._setCurrentRegisteredParameter=function(e,t,n){var o=this;if((e=[].concat(e))[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The msb value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){o.sendControlChange(6,e[0],t,{time:n})})),e[1]=Math.floor(e[1]),0<=e[1]&&e[1]<=127&&r.toMIDIChannels(t).forEach((function(){o.sendControlChange(38,e[1],t,{time:n})})),this},i.prototype._deselectRegisteredParameter=function(e,t){var n=this;return r.toMIDIChannels(e).forEach((function(){n.sendControlChange(101,127,e,{time:t}),n.sendControlChange(100,127,e,{time:t})})),this},i.prototype.setRegisteredParameter=function(e,t,n,o){var i=this;if(o=o||{},!Array.isArray(e)){if(!r.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=r.MIDI_REGISTERED_PARAMETER[e]}return r.toMIDIChannels(n).forEach((function(){i._selectRegisteredParameter(e,n,o.time),i._setCurrentRegisteredParameter(t,n,o.time),i._deselectRegisteredParameter(n,o.time)})),this},i.prototype.setNonRegisteredParameter=function(e,t,n,o){var i=this;if(o=o||{},!(0<=e[0]&&e[0]<=127&&0<=e[1]&&e[1]<=127))throw new Error("Position 0 and 1 of the 2-position parameter array must both be between 0 and 127.");return t=[].concat(t),r.toMIDIChannels(n).forEach((function(){i._selectNonRegisteredParameter(e,n,o.time),i._setCurrentRegisteredParameter(t,n,o.time),i._deselectRegisteredParameter(n,o.time)})),this},i.prototype.incrementRegisteredParameter=function(e,t,n){var o=this;if(n=n||{},!Array.isArray(e)){if(!r.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=r.MIDI_REGISTERED_PARAMETER[e]}return r.toMIDIChannels(t).forEach((function(){o._selectRegisteredParameter(e,t,n.time),o.sendControlChange(96,0,t,{time:n.time}),o._deselectRegisteredParameter(t,n.time)})),this},i.prototype.decrementRegisteredParameter=function(e,t,n){if(n=n||{},!Array.isArray(e)){if(!r.MIDI_REGISTERED_PARAMETER[e])throw new TypeError("The specified parameter is not available.");e=r.MIDI_REGISTERED_PARAMETER[e]}return r.toMIDIChannels(t).forEach(function(){this._selectRegisteredParameter(e,t,n.time),this.sendControlChange(97,0,t,{time:n.time}),this._deselectRegisteredParameter(t,n.time)}.bind(this)),this},i.prototype.setPitchBendRange=function(e,t,n,o){var i=this;if(o=o||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return r.toMIDIChannels(n).forEach((function(){i.setRegisteredParameter("pitchbendrange",[e,t],n,{time:o.time})})),this},i.prototype.setModulationRange=function(e,t,n,o){var i=this;if(o=o||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return r.toMIDIChannels(n).forEach((function(){i.setRegisteredParameter("modulationrange",[e,t],n,{time:o.time})})),this},i.prototype.setMasterTuning=function(e,t,n){var o=this;if(n=n||{},(e=parseFloat(e)||0)<=-65||64<=e)throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");var i=Math.floor(e)+64,a=e-Math.floor(e),s=(a=Math.round((a+1)/2*16383))>>7&127,l=127&a;return r.toMIDIChannels(t).forEach((function(){o.setRegisteredParameter("channelcoarsetuning",i,t,{time:n.time}),o.setRegisteredParameter("channelfinetuning",[s,l],t,{time:n.time})})),this},i.prototype.setTuningProgram=function(e,t,n){var o=this;if(n=n||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The program value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){o.setRegisteredParameter("tuningprogram",e,t,{time:n.time})})),this},i.prototype.setTuningBank=function(e,t,n){var o=this;if(n=n||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The bank value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){o.setRegisteredParameter("tuningbank",e,t,{time:n.time})})),this},i.prototype.sendChannelMode=function(e,t,n,o){if(o=o||{},"string"==typeof e){if(!(e=r.MIDI_CHANNEL_MODE_MESSAGES[e]))throw new TypeError("Invalid channel mode message name.")}else if(!(120<=(e=Math.floor(e))&&e<=127))throw new RangeError("Channel mode numerical identifiers must be between 120 and 127.");if((t=Math.floor(t)||0)<0||127<t)throw new RangeError("Value must be an integer between 0 and 127.");return r.toMIDIChannels(n).forEach(function(n){this.send((r.MIDI_CHANNEL_MESSAGES.channelmode<<4)+(n-1),[e,t],this._parseTimeParameter(o.time))}.bind(this)),this},i.prototype.sendProgramChange=function(e,t,n){var o=this;if(n=n||{},e=Math.floor(e),isNaN(e)||e<0||127<e)throw new RangeError("Program numbers must be between 0 and 127.");return r.toMIDIChannels(t).forEach((function(t){o.send((r.MIDI_CHANNEL_MESSAGES.programchange<<4)+(t-1),[e],o._parseTimeParameter(n.time))})),this},i.prototype.sendChannelAftertouch=function(e,t,n){var o=this;n=n||{},e=parseFloat(e),(isNaN(e)||e<0||1<e)&&(e=.5);var i=Math.round(127*e);return r.toMIDIChannels(t).forEach((function(e){o.send((r.MIDI_CHANNEL_MESSAGES.channelaftertouch<<4)+(e-1),[i],o._parseTimeParameter(n.time))})),this},i.prototype.sendPitchBend=function(e,t,n){var o=this;if(n=n||{},isNaN(e)||e<-1||1<e)throw new RangeError("Pitch bend value must be between -1 and 1.");var i=Math.round((e+1)/2*16383),a=i>>7&127,s=127&i;return r.toMIDIChannels(t).forEach((function(e){o.send((r.MIDI_CHANNEL_MESSAGES.pitchbend<<4)+(e-1),[s,a],o._parseTimeParameter(n.time))})),this},i.prototype._parseTimeParameter=function(e){var t,n=parseFloat(e);return"string"==typeof e&&"+"===e.substring(0,1)?n&&0<n&&(t=r.time+n):n>r.time&&(t=n),t},i.prototype._convertNoteToArray=function(e){var t=[];return Array.isArray(e)||(e=[e]),e.forEach((function(e){t.push(r.guessNoteNumber(e))})),t},t.exports?t.exports=r:e.WebMidi||(e.WebMidi=r)}(e)})),zr=t((function(e){!function(t,n,r){if(t){for(var o,i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},a={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},l={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},u=1;u<20;++u)i[111+u]="f"+u;for(u=0;u<=9;++u)i[u+96]=u.toString();_.prototype.bind=function(e,t,n){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,n),this},_.prototype.unbind=function(e,t){return this.bind.call(this,e,(function(){}),t)},_.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},_.prototype.reset=function(){return this._callbacks={},this._directMap={},this},_.prototype.stopCallback=function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1)return!1;if(function e(t,r){return null!==t&&t!==n&&(t===r||e(t.parentNode,r))}(t,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var r=e.composedPath()[0];r!==e.target&&(t=r)}return"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},_.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},_.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);o=null},_.init=function(){var e=_(n);for(var t in e)"_"!==t.charAt(0)&&(_[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},_.init(),t.Mousetrap=_,e.exports&&(e.exports=_)}function c(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function d(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return i[e.which]?i[e.which]:a[e.which]?a[e.which]:String.fromCharCode(e.which).toLowerCase()}function f(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function h(e,t,n){return n||(n=function(){if(!o)for(var e in o={},i)e>95&&e<112||i.hasOwnProperty(e)&&(o[i[e]]=e);return o}()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function p(e,t){var n,r,o,i=[];for(n=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),o=0;o<n.length;++o)r=n[o],l[r]&&(r=l[r]),t&&"keypress"!=t&&s[r]&&(r=s[r],i.push("shift")),f(r)&&i.push(r);return{key:r,modifiers:i,action:t=h(r,i,t)}}function _(e){var t=this;if(e=e||n,!(t instanceof _))return new _(e);t.target=e,t._callbacks={},t._directMap={};var r,o={},i=!1,a=!1,s=!1;function l(e){e=e||{};var t,n=!1;for(t in o)e[t]?n=!0:o[t]=0;n||(s=!1)}function u(e,n,r,i,a,s){var l,u,c,d,h=[],p=r.type;if(!t._callbacks[e])return[];for("keyup"==p&&f(e)&&(n=[e]),l=0;l<t._callbacks[e].length;++l)if(u=t._callbacks[e][l],(i||!u.seq||o[u.seq]==u.level)&&p==u.action&&("keypress"==p&&!r.metaKey&&!r.ctrlKey||(c=n,d=u.modifiers,c.sort().join(",")===d.sort().join(",")))){var _=!i&&u.combo==a,m=i&&u.seq==i&&u.level==s;(_||m)&&t._callbacks[e].splice(l,1),h.push(u)}return h}function h(e,n,r,o){t.stopCallback(n,n.target||n.srcElement,r,o)||!1===e(n,r)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(n),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(n))}function m(e){"number"!=typeof e.which&&(e.which=e.keyCode);var n=d(e);n&&("keyup"!=e.type||i!==n?t.handleKey(n,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):i=!1)}function g(e,t,n,a){function u(t){return function(){s=t,++o[e],clearTimeout(r),r=setTimeout(l,1e3)}}function c(t){h(n,t,e),"keyup"!==a&&(i=d(t)),setTimeout(l,10)}o[e]=0;for(var f=0;f<t.length;++f){var _=f+1===t.length?c:u(a||p(t[f+1]).action);b(t[f],_,a,e,f)}}function b(e,n,r,o,i){t._directMap[e+":"+r]=n;var a,s=(e=e.replace(/\s+/g," ")).split(" ");s.length>1?g(e,s,n,r):(a=p(e,r),t._callbacks[a.key]=t._callbacks[a.key]||[],u(a.key,a.modifiers,{type:a.action},o,e,i),t._callbacks[a.key][o?"unshift":"push"]({callback:n,modifiers:a.modifiers,action:a.action,seq:o,level:i,combo:e}))}t._handleKey=function(e,t,n){var r,o=u(e,t,n),i={},c=0,d=!1;for(r=0;r<o.length;++r)o[r].seq&&(c=Math.max(c,o[r].level));for(r=0;r<o.length;++r)if(o[r].seq){if(o[r].level!=c)continue;d=!0,i[o[r].seq]=1,h(o[r].callback,n,o[r].combo,o[r].seq)}else d||h(o[r].callback,n,o[r].combo);var p="keypress"==n.type&&a;n.type!=s||f(e)||p||l(i),a=d&&"keydown"==n.type},t._bindMultiple=function(e,t,n){for(var r=0;r<e.length;++r)b(e[r],t,n)},c(e,"keypress",m),c(e,"keydown",m),c(e,"keyup",m)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)})),Ur={"text/plain":"Text","text/html":"Url",default:"Text"};var Yr=function(e,t){var n,r,o,i,a,s,l=!1;t||(t={}),n=t.debug||!1;try{if(o=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],r=0;r<e.rangeCount;r++)n.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),i=document.createRange(),a=document.getSelection(),(s=document.createElement("span")).textContent=e,s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",(function(r){if(r.stopPropagation(),t.format)if(r.preventDefault(),void 0===r.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var o=Ur[t.format]||Ur.default;window.clipboardData.setData(o,e)}else r.clipboardData.clearData(),r.clipboardData.setData(t.format,e);t.onCopy&&(r.preventDefault(),t.onCopy(r.clipboardData))})),document.body.appendChild(s),i.selectNodeContents(s),a.addRange(i),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(o){n&&console.error("unable to copy using execCommand: ",o),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),l=!0}catch(o){n&&console.error("unable to copy using clipboardData: ",o),n&&console.error("falling back to prompt"),r=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"â":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(r,e)}}finally{a&&("function"==typeof a.removeRange?a.removeRange(i):a.removeAllRanges()),s&&document.body.removeChild(s),o()}return l};return function(e){var t=Object.assign({},{enabled:!0,gui:new Fr.GUI,midiPerColor:4,colors:["#ee907b","#2ed9c3","#4888f5","#aa82ff"]},e),n=[],r=t.gui,o=[],i={},a=!1,s=!1,l=null,u=function(){navigator.requestMIDIAccess&&(!window.env||"production"!==window.env)&&(l=Vr).enable((function(e){e?console.error("WebMIDI is not supported in this browser."):(console.log("MIDI devices successfully connected."),b())}))},c=function(){document.addEventListener("keydown",(function(e){18===e.keyCode&&(a=!0)})),document.addEventListener("keyup",(function(e){18===e.keyCode&&(a=!1)})),document.addEventListener("keyup",(function(e){17===e.keyCode&&t.toggle()}))},d=function(){var e=document.querySelector("body"),t=document.createElement("div");t.classList.add("gui-save"),t.innerHTML='\n      <div class="gui-save__inner">\n        <span class="gui-save__close">&times;</span>\n        <p class="gui-save__clipboard-notification">This code has been saved to your clipboard.</p>\n        <textarea\n          class="gui-save__textarea"\n          name="gui-save-text"\n          id="gui-save-text"\n          autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"\n        ></textarea>\n      </div>\n    ',e.appendChild(t),e.insertBefore(t,null),e.insertBefore(t,e.childNodes[0]||null)},f=function(){zr.bind("alt+s",h),zr.bind("esc",m),document.querySelector(".gui-save__close").addEventListener("click",m)},h=function(){var e=t._getAggregatedSettings();(e=JSON.stringify(e,null,1)).replace(/\\"/g,"ï¿¿"),(e=e.replace(/"([^"]+)":/g,"$1:").replace(/\uFFFF/g,'\\"')).replace(/"/g,"'"),document.querySelector(".gui-save__textarea").value=e,p(),_()},p=function(){document.querySelector(".gui-save").classList.add("is-visible")},_=function(){Yr(document.querySelector(".gui-save__textarea").value);var e=document.querySelector(".gui-save__clipboard-notification");e.classList.add("is-visible"),window.setTimeout((function(){e.classList.remove("is-visible")}),2e3)},m=function(){document.querySelector(".gui-save").classList.remove("is-visible")},g=function(){var e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode("\n      .dg.ac {\n        z-index: 9999;\n      }\n\n      .gui-save {\n        display: none;\n        position: fixed;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        justify-content: center;\n        align-items: center;\n        box-sizing: border-box;\n        background-color: rgba(255, 255, 255, 0.1);\n        z-index: 999;\n      }\n\n      .gui-save *, .gui-save *:before, .gui-save *:after {\n        box-sizing: inherit;\n      }\n\n      .gui-save.is-visible {\n        display: flex;\n      }\n\n      .gui-save__inner {\n        position: relative;\n        width: 100%;\n        max-width: 400px;\n        margin: 20px;\n      }\n\n      .gui-save__textarea {\n        appearance: none;\n        border-radius: 5px;\n        border: none;\n        background-color: #1f1f1f;\n        width: 100%;\n        height: 300px;\n        padding: 25px 23px;\n        border-left: 4px solid #5887da;\n        font-family: 'Courier New', Courier, 'Lucida Sans Typewriter', 'Lucida Typewriter', monospace;\n        font-size: 14px;\n        line-height: 1.5;\n        font-weight: normal;\n        color: white;\n        transition: border-color 0.2s;\n      }\n\n      .gui-save__textarea:focus {\n        outline: none;\n        border-color: #ee907b;\n      }\n\n      .gui-save__clipboard-notification {\n        font-family: 'Courier New', Courier, 'Lucida Sans Typewriter', 'Lucida Typewriter', monospace;\n        font-size: 13px;\n        pointer-events: none;\n        position: absolute;\n        bottom: -45px;\n        left: 0;\n        right: 0;\n        opacity: 0;\n        color: #5887da;\n        transition: opacity 0.4s;\n      }\n\n      .gui-save__clipboard-notification.is-visible {\n        opacity: 1;\n      }\n\n      .gui-save__close {\n        position: absolute;\n        width: 35px;\n        height: 35px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        top: 0;\n        right: 0;\n        z-index: 1;\n        font-size: 18px;\n        cursor: pointer;\n        color: #fff;\n      }\n\n      .gui-save__close:active {\n        opacity: 0.7;\n      }\n    ")),document.querySelector("head").appendChild(e)},b=function(){l.inputs.forEach((function(e){e.addListener("midimessage","all",v)}))},v=function(e){var t=Rn(e.data,3),n=t[0],r=t[1],o=t[2];a&&console.log("command: ".concat(n," / note: ").concat(r," / velocity: ").concat(o)),y(r,o),E(r,o)},y=function(e,n){var r=o.indexOf(e);if(!(r<0)){var i=t._getNumericControllerAtIndex(r);if(i){var a=i.__min,s=i.__max,l=i.__step,u=l||(s-a)/127,c=t._mapRange(0,127,a,s,n),d=t._snap(u.toFixed(5),c);i.setValue(d)}}},E=function(e,n){i[e]&&i[e].call(t,n)},S=function(){return n.length?n:[t.gui]},w=function(){t.getControllers(!1).forEach((function(e,n){var r=Math.floor(n/t.midiPerColor),o=t.colors[r],i=e.domElement.closest(".cr.number.has-slider");i&&(i.style.borderLeftColor="".concat(o),i.querySelector(".slider-fg").style.backgroundColor="".concat(o))}))};return t._mapRange=function(e,t,n,r,o){return(o-e)*(r-n)/(t-e)+n},t._snap=function(e,t){return Math.round(t/e)*e},t._getNumericControllerAtIndex=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.getControllers(n).filter((function(e){return void 0!==On(e.min)&&void 0!==On(e.max)}));return r[e]},t._getAggregatedSettings=function(){return S().reduce((function(e,t){return e[t.name]=t.__controllers.reduce((function(e,t){return e[t.property]=t.getValue(),e}),{}),e}),{})},t.add=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=r.add.apply(r,t);return w(),o},t.addColor=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.addColor.apply(r,t)},t.setFolder=function(e){var o=t.gui.addFolder(e);return n.push(o),r=o,o},t.getControllers=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=S(),n=e?t.filter((function(e){return!e.closed})):t;return n.reduce((function(e,t){return e.concat(t.__controllers)}),[])},t.removeFolder=function(e){var o=n.findIndex((function(t){return t.name===e.name}));n.splice(o,1),t.gui.removeFolder(e),r=t.gui},t.connectMidiRange=function(e,t){for(var n=e,r=t+1;n<r;n++)o.push(n)},t.addControl=function(e,t){i[e]=t},t.destroy=function(){t.gui.destroy(),l&&(l.inputs.forEach((function(e){e.removeListener("midimessage","all")})),l.disable())},t.clear=function(){t.gui.destroy(),t.gui=new Fr.GUI,r=t.gui,i={}},t.hide=function(){s=!0,t.gui.hide()},t.show=function(){s=!1,t.gui.show()},t.toggle=function(){(s=!s)?t.hide():t.show()},t.update=function(){t.getControllers().forEach((function(e){e.updateDisplay()}))},u(),c(),d(),f(),g(),t}}));
